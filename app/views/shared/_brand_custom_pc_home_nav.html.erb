<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
<header
  class="sticky top-0 z-50 bg-white/80 dark:bg-background-dark/80 backdrop-blur-md border-b border-solid border-[#f2f0f4] dark:border-slate-800"
>
  <div
    class="max-w-[1200px] mx-auto px-10 py-4 flex items-center justify-between gap-6"
  >
    <div class="flex items-center gap-8">
    <%= link_to root_path do %>
        <img
          src="https://ik.imagekit.io/posturacorretta/logo_pc_scontornato.png?updatedAt=1747975596766"
          alt="PosturaCorretta"
          class="h-8 w-auto"
        />
      <% end %>
    </div>
    <div class="hidden md:flex flex-1 justify-center items-center gap-8">
      <%= link_to root_path(anchor: "percorso"), class: "inline-flex items-center gap-1 text-sm font-medium text-slate-500 hover:text-primary transition-colors" do %>
        <span class="material-symbols-outlined text-[18px] leading-none">route</span>
        Percorso
      <% end %>
      <details class="relative inline-flex items-center justify-center" data-nav-dropdown>
        <summary
          class="list-none inline-flex items-center gap-1 text-sm font-medium text-slate-500 hover:text-primary transition-colors cursor-pointer"
          aria-label="Apri menu rete"
        >
          <span class="material-symbols-outlined text-[18px] leading-none">hub</span>
          Rete
          <span class="material-symbols-outlined text-[18px] leading-none">expand_more</span>
        </summary>
        <div class="absolute z-50 mt-2 w-52 rounded-xl border border-[#f2f0f4] bg-white shadow-lg p-2"
             style="top: 100%; left: 50%; transform: translateX(-50%);">
          <%= link_to "Persone", posturacorretta_rete_path, class: "block px-3 py-2 text-sm font-medium text-left hover:text-primary" %>
          <%= link_to "Insegnanti", posturacorretta_rete_path, class: "block px-3 py-2 text-sm font-medium text-left hover:text-primary" %>
          <%= link_to "Centri", posturacorretta_rete_path, class: "block px-3 py-2 text-sm font-medium text-left hover:text-primary" %>
          <%= link_to "Percorsi formativi", posturacorretta_rete_path, class: "block px-3 py-2 text-sm font-medium text-left hover:text-primary" %>
        </div>
      </details>
      <details class="relative inline-flex items-center justify-center" data-nav-dropdown>
        <summary
          class="list-none inline-flex items-center gap-1 text-sm font-medium text-slate-500 hover:text-primary transition-colors cursor-pointer"
          aria-label="Apri menu risorse"
        >
          <span class="material-symbols-outlined text-[18px] leading-none">library_books</span>
          Risorse
          <span class="material-symbols-outlined text-[18px] leading-none">expand_more</span>
        </summary>
        <div class="absolute z-50 mt-2 w-52 rounded-xl border border-[#f2f0f4] bg-white shadow-lg p-2"
             style="top: 100%; left: 50%; transform: translateX(-50%);">
          <%= link_to "Contenuti", posturacorretta_contenuti_path, class: "block px-3 py-2 text-sm font-medium text-left hover:text-primary" %>
          <%= link_to "Corsi online", posturacorretta_corsi_online_path, class: "block px-3 py-2 text-sm font-medium text-left hover:text-primary" %>
          <%= link_to "Eventi", posturacorretta_eventi_path, class: "block px-3 py-2 text-sm font-medium text-left hover:text-primary" %>
          <%= link_to "Servizi", posturacorretta_servizi_path, class: "block px-3 py-2 text-sm font-medium text-left hover:text-primary" %>
          <%= link_to "Manifesto", posturacorretta_manifesto_path, class: "block px-3 py-2 text-sm font-medium text-left hover:text-primary" %>
          <%= link_to "Libri", books_path, class: "block px-3 py-2 text-sm font-medium text-left hover:text-primary" %>
        </div>
      </details>
      <%= link_to root_path(anchor: "progetto"),
                  class: "inline-flex items-center gap-1 text-sm font-medium text-slate-500 hover:text-primary transition-colors" do %>
        <span class="material-symbols-outlined text-[18px] leading-none">rocket_launch</span>
        Progetto
      <% end %>
      <!--a
        class="text-sm font-medium hover:text-primary transition-colors"
        href="#progetto"
        >ðŸ”Ž &nbsp; Professionisti e centri</a
      -->
    </div>
    <div class="hidden md:flex items-center gap-3">
      <% if Current.user.present? %>
        <%= link_to dashboard_home_path do %>
          <div
            class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-7 border border-[#e7edf3]"
            style="
              background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuA2LXURXbE3_UxsTFxRYAnn3JHwvdxCjtrsE9cnM4fOM7RYPSwxJmYQdF4JdCKHFk7yEaaZaEZ-zhrko0djKgMKoRE5_hyLTKjX9wMnfXf2oI6J3pHtPS9cHds-5cRTCM7qxcz7nvr3Gg_InsulvJloG1sn7u9p9TOx8XoC7rC1vm5w7yLPTGoLLEKHsQzOmphuw2jxiis1kyB19G-7veU7KBNLToUtKcj0D_euTGmHqDyYrDfvtbxIZVJWCcqt-s0A3sGfl0v1ZGA');
            "
          ></div>
        <% end %>
      <% else %>
        <%= link_to "Accedi",
                    new_session_path,
                    class: "text-sm font-semibold text-[#0d151c] dark:text-gray-300 hover:text-primary transition-colors" %>
        <%= link_to "Registrati",
                    new_registration_path,
                    class: "inline-flex items-center rounded-full border border-primary/40 px-4 py-2 text-sm font-semibold text-primary hover:bg-primary/10 transition-colors" %>
      <% end %>
    </div>
    <div class="md:hidden flex items-center">
      <details class="relative">
        <summary
          class="list-none flex items-center justify-center size-9 rounded-full border border-[#f2f0f4] bg-white/90 dark:bg-slate-900/80 dark:border-slate-700 text-slate-700 dark:text-slate-200"
          aria-label="Apri menu"
        >
          <span class="material-symbols-outlined text-lg">menu</span>
        </summary>
        <div
          class="absolute right-0 mt-3 w-64 rounded-2xl border border-[#f2f0f4] dark:border-slate-700 bg-white dark:bg-slate-900 shadow-xl p-3 z-50"
        >
          <%= link_to root_path(anchor: "percorso"), class: "flex items-center gap-2 px-3 py-2 text-sm font-semibold hover:text-primary" do %>
            <span class="material-symbols-outlined text-[18px] leading-none">route</span>
            Percorso
          <% end %>
          <div class="h-px bg-slate-100 dark:bg-slate-800 my-2"></div>
          <div class="px-3 py-2 text-xs font-bold uppercase tracking-wide text-slate-400 flex items-center gap-2">
            <span class="material-symbols-outlined text-[16px] leading-none">hub</span>
            Rete
          </div>
          <%= link_to "Persone", posturacorretta_rete_path, class: "block px-3 py-2 text-sm font-semibold hover:text-primary" %>
          <%= link_to "Insegnanti", posturacorretta_rete_path, class: "block px-3 py-2 text-sm font-semibold hover:text-primary" %>
          <%= link_to "Centri", posturacorretta_rete_path, class: "block px-3 py-2 text-sm font-semibold hover:text-primary" %>
          <%= link_to "Percorsi formativi", posturacorretta_rete_path, class: "block px-3 py-2 text-sm font-semibold hover:text-primary" %>
          <div class="h-px bg-slate-100 dark:bg-slate-800 my-2"></div>
          <div class="px-3 py-2 text-xs font-bold uppercase tracking-wide text-slate-400 flex items-center gap-2">
            <span class="material-symbols-outlined text-[16px] leading-none">library_books</span>
            Risorse
          </div>
          <%= link_to "Contenuti", posturacorretta_contenuti_path, class: "block px-3 py-2 text-sm font-semibold hover:text-primary" %>
          <%= link_to "Corsi online", posturacorretta_corsi_online_path, class: "block px-3 py-2 text-sm font-semibold hover:text-primary" %>
          <%= link_to "Eventi", posturacorretta_eventi_path, class: "block px-3 py-2 text-sm font-semibold hover:text-primary" %>
          <%= link_to "Servizi", posturacorretta_servizi_path, class: "block px-3 py-2 text-sm font-semibold hover:text-primary" %>
          <%= link_to "Manifesto", posturacorretta_manifesto_path, class: "block px-3 py-2 text-sm font-semibold hover:text-primary" %>
          <%= link_to "Libri", books_path, class: "block px-3 py-2 text-sm font-semibold hover:text-primary" %>
          <%= link_to "Progetto", root_path(anchor: "progetto"), class: "block px-3 py-2 text-sm font-semibold hover:text-primary" %>
          <!--a class="block px-3 py-2 text-sm font-semibold hover:text-primary" href="#">ðŸ”Ž Professionisti e centri</a-->
          <div class="h-px bg-slate-100 dark:bg-slate-800 my-2"></div>
          <% if Current.user.present? %>
            <%= link_to "Profilo", dashboard_home_path, class: "block px-3 py-2 text-sm font-semibold hover:text-primary" %>
          <% else %>
            <%= link_to "Accedi", new_session_path, class: "block px-3 py-2 text-sm font-semibold hover:text-primary" %>
            <%= link_to "Registrati", new_registration_path, class: "block px-3 py-2 text-sm font-semibold text-primary" %>
          <% end %>
        </div>
      </details>
    </div>
  </div>
</header>
<script>
  (function () {
    const nav = document.querySelector("header");
    if (!nav) return;

    const dropdowns = nav.querySelectorAll("details[data-nav-dropdown]");
    if (!dropdowns.length) return;

    // Keep only one desktop dropdown open at a time.
    dropdowns.forEach((dropdown) => {
      dropdown.addEventListener("toggle", () => {
        if (!dropdown.open) return;
        dropdowns.forEach((other) => {
          if (other !== dropdown) other.open = false;
        });
      });
    });

    // Close dropdowns on outside click.
    document.addEventListener("click", (event) => {
      dropdowns.forEach((dropdown) => {
        if (!dropdown.open) return;
        if (!dropdown.contains(event.target)) dropdown.open = false;
      });
    });

    // Close dropdowns on Escape.
    document.addEventListener("keydown", (event) => {
      if (event.key !== "Escape") return;
      dropdowns.forEach((dropdown) => {
        dropdown.open = false;
      });
    });
  })();
</script>
