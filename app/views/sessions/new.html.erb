<%= render 'shared/nav_partial_post' %>
<br><br>

<% active_tab = params[:tab] == 'signup' ? 'signup' : 'login' %>

<div class="mx-auto md:w-2/3 w-full">
  <div class="border-b border-slate-200 mb-6">
    <nav class="-mb-px flex space-x-6" aria-label="Tabs">
      <%= link_to url_for(request.query_parameters.merge(tab: 'login')),
        class: "whitespace-nowrap border-b-2 px-1 py-2 text-sm font-medium " +
               (active_tab == 'login' ?
                 "border-blue-600 text-blue-700" :
                 "border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300") do %>
        Ho un account
      <% end %>

      <%= link_to url_for(request.query_parameters.merge(tab: 'signup')),
        class: "whitespace-nowrap border-b-2 px-1 py-2 text-sm font-medium " +
               (active_tab == 'signup' ?
                 "border-blue-600 text-blue-700" :
                 "border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300") do %>
        Crea un account
      <% end %>
    </nav>
  </div>

  <% if flash[:notice] %>
    <p class="py-2 px-3 bg-green-50 mb-5 text-green-600 font-medium rounded-lg inline-block"><%= flash[:notice] %></p>
  <% end %>
  <% if flash[:alert] %>
    <p class="py-2 px-3 bg-red-50 mb-5 text-red-600 font-medium rounded-lg inline-block"><%= flash[:alert] %></p>
  <% end %>

  <% if active_tab == 'login' %>
    <h1 class="font-bold text-4xl mb-6">Accedi</h1>

    <%= form_with url: session_url, class: "contents" do |form| %>
      <div class="my-5">
        <%= form.label :email_address, "Email", class: "block text-sm font-medium text-gray-700" %>
        <%= form.email_field :email_address, required: true, autofocus: true,
              class: "block w-full rounded-md border border-gray-300 px-3 py-2 mt-2 focus:ring-2 focus:ring-blue-600" %>
      </div>

      <div class="my-5">
        <%= form.label :password, "Password", class: "block text-sm font-medium text-gray-700" %>
        <%= form.password_field :password, required: true, autocomplete: "current-password",
              class: "block w-full rounded-md border border-gray-300 px-3 py-2 mt-2 focus:ring-2 focus:ring-blue-600" %>
      </div>

      <%= form.submit "Accedi",
            class: "rounded-md bg-blue-600 hover:bg-blue-500 text-white px-3.5 py-2.5 font-medium cursor-pointer" %>
    <% end %>

  <% else %>
    <h1 class="font-bold text-4xl mb-6">Crea un account</h1>

    <%= form_with url: registration_path, scope: :lead, method: :post, class: "space-y-5" do |form| %>
      <%= form.hidden_field :referral_code, value: params[:ref] if params[:ref].present? %>
 <div>
        <%= form.label :name, "Nome e cognome", class: "block text-sm font-medium text-gray-700" %>
        <%= form.text_field :name, required: true,
              class: "block w-full rounded-md border border-gray-300 px-3 py-2 mt-2 focus:ring-2 focus:ring-blue-600" %>
      </div>

      <div>
        <%= form.label :email, "Email", class: "block text-sm font-medium text-gray-700" %>
        <%= form.email_field :email, required: true,
              class: "block w-full rounded-md border border-gray-300 px-3 py-2 mt-2 focus:ring-2 focus:ring-blue-600" %>
      </div>

      <div>
        <%= form.label :username, "Username", class: "block text-sm font-medium text-gray-700" %>
        <%= form.text_field :username, required: true,
              class: "block w-full rounded-md border border-gray-300 px-3 py-2 mt-2 focus:ring-2 focus:ring-blue-600" %>
      </div>

      <div>
        <%= form.label :phone, "Telefono", class: "block text-sm font-medium text-gray-700" %>
        <%= form.telephone_field :phone,
              class: "block w-full rounded-md border border-gray-300 px-3 py-2 mt-2 focus:ring-2 focus:ring-blue-600" %>
      </div>

      <div>
        <%= form.label :password, "Password", class: "block text-sm font-medium text-gray-700" %>
        <%= form.password_field :password, required: true,
              class: "block w-full rounded-md border border-gray-300 px-3 py-2 mt-2 focus:ring-2 focus:ring-blue-600" %>
      </div>

      <div>
        <%= form.submit "Registrati",
              class: "rounded-md px-3.5 py-2.5 bg-blue-600 hover:bg-blue-500 text-white font-medium cursor-pointer" %>
      </div>
    <% end %>
  <% end %>
</div>
