<!-- Breadcrumb + Title + Actions -->
<div class="mb-4 flex items-start justify-between gap-3">
  <div class="flex-1 min-w-0">
    <nav class="text-sm text-slate-600">
      <%= taxbranch_breadcrumb(@taxbranch) %>
    </nav>
    <h1 class="text-xl font-bold mt-1">
      <%= taxbranch_label(@taxbranch) %>
    </h1>
    <!-- Esempio dentro _node.html.erb, accanto al titolo/link del nodo -->
<div class="flex items-center gap-2">
 

  <%= link_to "âœï¸ Modifica", edit_taxbranch_path(@taxbranch),
      class: "text-sm text-blue-700 hover:underline" %>

  <%= link_to "ï¼‹ Figlio", new_superadmin_taxbranch_path(parent_id: @taxbranch.id),
      class: "text-sm text-green-700 hover:underline" %>

  <%= button_to "ðŸ—‘ï¸ Elimina",
      superadmin_taxbranch_path(@taxbranch),
      method: :delete,
      form: { data: { turbo_confirm: "Eliminare â€œ#{@taxbranch.slug_label}â€ e le sue sottocategorie?" } },
      class: "text-sm text-red-700 hover:underline" %>
</div>
  </div>

  <div class="shrink-0 flex items-center gap-2">
    <%# Mostra il pulsante "Aggiungi padre (radice)" solo alla radice %>
    <% if @taxbranch.parent.nil? %>
      <%= link_to "ï¼‹ associa a padre", superadmin_taxbranches_path(children_id: @taxbranch.id),
          class: "inline-flex items-center rounded-md border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-50" %>
       <%= link_to "ï¼‹ crea padre", new_superadmin_taxbranch_path(children_id: @taxbranch.id),
          class: "inline-flex items-center rounded-md border border-slate-300 bg-white px-3 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-50" %>

    <% end %>
  </div>
</div>

<% children = @taxbranch.children.ordered %>
<% if children.any? %>
  <ul class="space-y-2">
    <%= render partial: "node", collection: children, as: :node %>
  </ul>
<% else %>
  <p class="text-gray-500 italic">Nessuna sottocategoria.</p>
<% end %>



<div class="mt-6">
  <%# Link di risalita unico, coerente con il breadcrumb %>
  <%= link_to "â¬…ï¸ Torna su",
              (@taxbranch.parent ? superadmin_taxbranch_path(@taxbranch.parent) : superadmin_taxbranches_path),
              class: "text-gray-600 hover:underline" %>
</div>
